[Unit]
Description=tinypad for SECCON CTF 2016 ONLINE
After=network.target

[Service]
# General setting
## Define some stuffs.
## Switch
ExecStart=/usr/bin/python3 /opt/tinypad/auth.py
#ExecStart=/opt/tinypad/tinypad-a19521f0d45d18880735481fb940b22b6e2ced2b
User=tinypad
Group=tinypad
WorkingDirectory=/home/tinypad/
StandardInput=socket
#StandardOutput=socket
## Define who runs this.

# Securing a service.
## Never get privileges.
NoNewPrivileges=true
## Prevent for fork bombing
CPUAccounting=true
CPUQuota=20%
MemoryAccounting=true
MemoryLimit=1G
TasksAccounting=true
TasksMax=10
## Make /tmp private
PrivateTmp=yes
## Drop some capabilities from player
## Syscall filter
SystemCallFilter=~@privilege @mount @keyring @obsolete madvise
## Make the whole filesystem readonly
ProtectSystem=full
## No more tuning the kernel
ProtectKernelTunables=yes
## Make sure that cgroups is never changed.
ProtectControlGroups=yes
# Don't connect anything.
PrivateNetwork=yes

[Install]
WantedBy=multi-user.target
Alias=tinypad.service
